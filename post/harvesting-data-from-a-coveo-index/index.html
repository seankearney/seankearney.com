<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-74650-7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-74650-7');
    </script>
    
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harvesting data from a Coveo index | Sean Kearney</title>
    <script>
        (function() {
            var savedTheme = localStorage.getItem('theme');
            if (!savedTheme) {
                document.documentElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.classList.toggle('dark', savedTheme === 'dark');
            }
        })();
    </script>
    <meta name="search-index" content="https://seankearney.com/search_index.en.js">
    <link rel="stylesheet" href="https://seankearney.com/tailwind.css">
    <script src="https://seankearney.com/js/elasticlunr.min.js"></script>
    <script src="https://seankearney.com/search.js" defer></script>
    <script src="https://seankearney.com/theme.js" defer></script>
    <script src="https://seankearney.com/mobile-menu.js" defer></script>
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://seankearney.com/rss.xml">
</head>
<body>
    <header class="bg-white dark:bg-gray-800 shadow-md fixed w-full top-0 z-50">
        <nav class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-6">
                <a href="https://seankearney.com" class="text-xl font-bold text-[var(--color-text-primary)]">Sean Kearney</a>
                <div class="hidden md:flex space-x-4">
                    <a href="https://seankearney.com/about" class="text-[var(--color-text-secondary)] hover:text-[var(--color-primary)]">About</a>
                    <a href="https://seankearney.com/post" class="text-[var(--color-text-secondary)] hover:text-[var(--color-primary)]">Blog</a>
                    <a href="https://seankearney.com/tags" class="text-[var(--color-text-secondary)] hover:text-[var(--color-primary)]">Categories</a>
                    <a href="https://seankearney.com/archive" class="text-[var(--color-text-secondary)] hover:text-[var(--color-primary)]">Archive</a>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <div class="relative">
                    <input id="search-input" type="search" class="w-48 px-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-[var(--color-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]" placeholder="Type to search..." aria-label="Search">
                    <div id="search-preview" class="absolute right-0 mt-2 w-96 max-w-screen-sm bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden z-50 hidden">
                    </div>
                </div>
                <button id="theme-toggle" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700" aria-label="Toggle dark mode">
                    <svg width="20" height="20" fill="none" stroke="currentColor" class="text-[var(--color-text-primary)]" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                </button>
                <button class="mobile-menu-button md:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700" aria-label="Menu">
                    <svg width="24" height="24" fill="none" stroke="currentColor" class="text-[var(--color-text-primary)]" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </nav>
        <div class="mobile-menu hidden md:hidden bg-white dark:bg-gray-800 w-full border-t dark:border-gray-700">
            <div class="container mx-auto px-4 py-2 flex flex-col space-y-2">
                <a href="https://seankearney.com/about" class="text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] py-2">About</a>
                <a href="https://seankearney.com/post" class="text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] py-2">Blog</a>
                <a href="https://seankearney.com/tags" class="text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] py-2">Categories</a>
                <a href="https://seankearney.com/archive" class="text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] py-2">Archive</a>
            </div>
        </div>
    </header>

    <div id="search-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 transition-opacity duration-200 ease-in-out">
        <div class="bg-white dark:bg-gray-800 w-full max-w-3xl mx-auto mt-16 sm:mt-20 rounded-lg shadow-xl overflow-hidden transform transition-transform duration-200">
            <div class="flex justify-between items-center p-4 border-b dark:border-gray-700">
                <h2 class="text-lg font-semibold text-[var(--color-text-primary)]">Search Results</h2>
                <button id="close-search" class="text-2xl text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-full w-8 h-8 flex items-center justify-center transition-colors duration-150" aria-label="Close search">×</button>
            </div>
            <div id="search-results" class="max-h-[80vh] sm:max-h-[70vh] overflow-y-auto p-4 space-y-4">
                <!-- Search results will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <main class="container mx-auto px-4 pt-20 pb-16 min-h-screen">
        
<div class="max-w-4xl mx-auto px-4 py-8">
    <article class="mb-16">
        <header class="mb-8">
            <h1 class="text-4xl font-bold text-[var(--text-primary)] mb-4">Harvesting data from a Coveo index</h1>
            <div class="text-gray-500 dark:text-gray-400">
                <time datetime="2009-07-07">July 07, 2009</time>
                
                <span class="mx-2">•</span>
                <span>
                    
                    <a href="https://seankearney.com/tags/search/" 
                       class="text-blue-600 dark:text-blue-400 hover:underline">Search</a>
                    , 
                    
                    <a href="https://seankearney.com/tags/coveo/" 
                       class="text-blue-600 dark:text-blue-400 hover:underline">Coveo</a>
                    
                    
                </span>
                
            </div>
        </header>

        <div class="prose dark:prose-invert max-w-none">
            <p>I've been working peripherally with <a href="http://www.coveo.com">Coveo</a> for the past couple years now. It hasn't been until recently that I've actually needed to start diving into the “API” to try and harvest the data. This, however, proved to be more difficult than one would expect from a Search product!</p>
<span id="continue-reading"></span>
<p>You see, Coveo wrote a lot of fancy controls (complete with AJAXy functions) that work intimately with their index. They have an “interface editor” that is supposed to help you customize the way these controls function and look. In a perfect world you will tailor your interface using this editor, drop a single user control on your page and you are up and running. However, there are times when these stock controls just don't cut it; you will either want to change the look, or function, to drastically to be handled with the interface editor. I found myself in such a position.</p>
<p>Coveo lists a few APIs in its online help section (<a href="http://www.coveo.com/en/support/online-help#-7b0HYBxJliUmL23Ke39K9UrX4HShCIBgEyTYkEAQ7MGIzeaS7B1pRyMpqyqBymVWZV1mFkDM7Z28995777333nvvvfe6O51OJ%2Fff%2Fz9cZmQBbPbOStrJniGAqsgfP358Hz8ifvzHd3%2FXL5dlscy%2FnZer3%2FXHf3zv9%2F1dd%2Fc%2F3d17eO%2Fh%2Fu%2F7u%2F6%2Bvyv9vfP7%2Fq7be%2Fv07%2B7vSw12f9%2Ff9%2Ff9Xdtqih9oLg810l9Olxdl0cz3T3ZOzEev86yeztOzZZvX59k0T49fnpnv7P8NaPcB9fi7TttyZ%2F93q343%2FNzlf3d%2Bt7rhtvi%2B%2Fz9653f9fwA%3D">Search Interface API</a>, Converter API, Connector API, and Security API), but none of them tell you how to get access to the raw data!</p>
<p>Before Coveo I was using <a href="http://lucene.apache.org/">Lucene</a> for various projects and it had a decent API that you can use to get access to your search results. You were then responsible for rendering these results. This is what I would have expected in terms of an API from Coveo. The Coveo Search Interface API is nothing more than a collection of the aforementioned ASP.NET controls that you can try to use in your Interface. I wasn't able to find any samples about how to get my data with some API calls, there was however, some MSDN style <a href="http://www.coveo.com/en/support/online-help#-7b0HYBxJliUmL23Ke39K9UrX4HShCIBgEyTYkEAQ7MGIzeaS7B1pRyMpqyqBymVWZV1mFkDM7Z28995777333nvvvfe6O51OJ%2Fff%2Fz9cZmQBbPbOStrJniGAqsgfP358Hz8ifvzHd3%2FXL5dlscy%2FnZer3%2FXHf3zv9%2F1dd%2Fc%2F3d17eO%2Fh%2Fu%2F7u%2F6%2Bv%2BuD3%2Fd33fl9f9ftvX36d%2Ff3pQa7v%2B%2Fv%2B%2Fv%2Brm01xQ80l4ca6S%2Bny4uyaOb7Jzsn5qPXeVZP5%2BnZss3r82yap8cvz8x39v8GtPuAevxdp225s%2F%2B7Vb8bfu7yvzu%2FW91wW3zf%2F9%2FBw72dA7y%2FLdB%2B19%2F1d%2F1%2FAA%3D%3D">class documentation</a>.</p>
<p>After some playing around I was able to perform a search using the following code. You need to specify the Collection ID you want to search on as well as the Query to perform. The results will then be populated into the resultArray object. There are many parameters you can set on the <a href="http://www.coveo.com/en/support/online-help#-7b0HYBxJliUmL23Ke39K9UrX4HShCIBgEyTYkEAQ7MGIzeaS7B1pRyMpqyqBymVWZV1mFkDM7Z28995777333nvvvfe6O51OJ%2Fff%2Fz9cZmQBbPbOStrJniGAqsgfP358Hz8ifvzHd3%2FXL5dlscy%2FnZer3%2FXHf3zv9%2F1dd%2Fc%2F3d17eO%2Fh%2Fu%2F7u%2F6%2Bv%2BuD3%2Fd33fl9f9ftvX36d%2Ff3pQa7v%2B%2Fv%2B%2Fv%2Brm01xQ80l4ca6S%2Bny4uyaOb7Jzsn5qPXeVZP5%2BnZss3r82yap8cvz8x39v8GtPuAevxdp225s%2F%2B7Vb8bfu7yvzu%2FW91wW3zf%2F9%2FBw72dA7y%2FLdB%2B19%2F1d%2F1%2FAA%3D%3D">SearchBuilder</a> object, which you can read about in the doc. This code will be used in an upcoming post about how to write an autocomplete text box with jQuery and Coveo.</p>
<pre data-lang="c#" style="background-color:#2b303b;color:#c0c5ce;" class="language-c# "><code class="language-c#" data-lang="c#"><span style="color:#b48ead;">using </span><span>Coveo.CES.Web.Search;  
</span><span style="color:#b48ead;">using </span><span>Coveo.CES.Web.Search.Controls;  
</span><span style="color:#b48ead;">using </span><span>Coveo.CES.Web.Search.Providers;  
</span><span>
</span><span style="color:#65737e;">// ....  
</span><span>
</span><span>ICESSearchProvider </span><span style="color:#bf616a;">provider </span><span>= </span><span style="color:#bf616a;">SearchUtilities</span><span>.</span><span style="color:#bf616a;">CreateDefaultSearchProvider</span><span>();  
</span><span>SearchBuilder </span><span style="color:#bf616a;">builder </span><span>= new SearchBuilder();  
</span><span style="color:#bf616a;">builder</span><span>.</span><span style="color:#bf616a;">AddCollection</span><span>(</span><span style="color:#d08770;">1234</span><span>); </span><span style="color:#65737e;">// add your collection id here  
</span><span style="color:#bf616a;">builder</span><span>.</span><span style="color:#bf616a;">Provider </span><span>= </span><span style="color:#bf616a;">provider</span><span>;  
</span><span style="color:#bf616a;">builder</span><span>.</span><span style="color:#bf616a;">ExpandQuery </span><span>= </span><span style="color:#d08770;">true</span><span>;  
</span><span style="color:#bf616a;">builder</span><span>.</span><span style="color:#bf616a;">RetrieveFirstSentences </span><span>= </span><span style="color:#d08770;">false</span><span>;  
</span><span style="color:#bf616a;">builder</span><span>.</span><span style="color:#bf616a;">ExcerptSize </span><span>= </span><span style="color:#d08770;">0</span><span>;  
</span><span style="color:#bf616a;">builder</span><span>.</span><span style="color:#bf616a;">FilterDuplicates </span><span>= </span><span style="color:#d08770;">true</span><span>;  
</span><span>builder.AddBasicEx </span><span style="color:#bf616a;">pres sion</span><span>(&quot;</span><span style="color:#bf616a;">Search for Me</span><span>&quot;</span><span style="background-color:#bf616a;color:#2b303b;">)</span><span>;  
</span><span>
</span><span style="color:#b48ead;">if </span><span>(</span><span style="color:#bf616a;">builder</span><span>.</span><span style="color:#bf616a;">ExecuteQuery</span><span>)  
</span><span>{  
</span><span>    QueryWrapper </span><span style="color:#bf616a;">newQueryWrapper </span><span>= </span><span style="color:#bf616a;">QueryWrapperFactory</span><span>.</span><span style="color:#bf616a;">GetNewQueryWrapper</span><span>(</span><span style="color:#bf616a;">builder</span><span>);  
</span><span>
</span><span>    </span><span style="color:#b48ead;">int </span><span style="color:#bf616a;">totalResults </span><span>= </span><span style="color:#bf616a;">newQueryWrapper</span><span>.</span><span style="color:#bf616a;">TotalCount</span><span>;  
</span><span>    ICESResult[] </span><span style="color:#bf616a;">resultArray </span><span>= </span><span style="color:#bf616a;">newQueryWrapper</span><span>.</span><span style="color:#bf616a;">GetResults</span><span>(</span><span style="color:#d08770;">0</span><span>, </span><span style="color:#d08770;">100</span><span>);  
</span><span>}
</span></code></pre>

        </div>
    </article>

    
    <nav class="flex justify-between items-center py-8 border-t border-gray-200 dark:border-gray-700">
        
        <a href="https:&#x2F;&#x2F;seankearney.com&#x2F;post&#x2F;coveo-with-sitecore-media&#x2F;" class="flex items-center text-blue-600 dark:text-blue-400 hover:underline">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Coveo with Sitecore Media
        </a>
        

        
        <a href="https:&#x2F;&#x2F;seankearney.com&#x2F;post&#x2F;new-home-pc-developer-rig&#x2F;" class="flex items-center text-blue-600 dark:text-blue-400 hover:underline">
            New Home PC &#x2F; Developer Rig
            <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </a>
        
    </nav>
    

    
    
    
    
</div>

    </main>

    <footer class="bg-white dark:bg-gray-800 border-t dark:border-gray-700">
        <div class="container mx-auto px-4 py-8">
            <!-- Social Links -->
            <div class="flex justify-center space-x-6 mb-6">
                
                <a href="https:&#x2F;&#x2F;github.com&#x2F;seankearney" 
                   class="text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors"
                   target="_blank" 
                   rel="noopener noreferrer"
                   title="GitHub">
                    
                    <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                    
                </a>
                
                <a href="https:&#x2F;&#x2F;twitter.com&#x2F;seankearney" 
                   class="text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors"
                   target="_blank" 
                   rel="noopener noreferrer"
                   title="Twitter">
                    
                    <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>
                    
                </a>
                
                <a href="https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;skearney" 
                   class="text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors"
                   target="_blank" 
                   rel="noopener noreferrer"
                   title="LinkedIn">
                    
                    <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                    
                </a>
                
                <a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;255194&#x2F;sean-kearney" 
                   class="text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors"
                   target="_blank" 
                   rel="noopener noreferrer"
                   title="StackOverflow">
                    
                    <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.95zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.36 1.618zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0z"/></svg>
                    
                </a>
                
            </div>

            <!-- Footer Links -->
            <div class="text-center space-y-4">
                <p class="text-gray-600 dark:text-gray-400">
                    © 2025 Sean Kearney
                </p>
                <p class="text-gray-600 dark:text-gray-400">
                    Powered by <a href="https://www.getzola.org/" class="hover:text-gray-900 dark:hover:text-white transition-colors">Zola</a>
                    &amp;
                    <span><a href="https://github.com/seankearney/zola-devin" class="hover:text-gray-900 dark:hover:text-white transition-colors">Devin</a></span>
                </p>
                <a href="https://seankearney.com/rss.xml" 
                   class="inline-block text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors"
                   title="RSS Feed">
                    <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"/>
                    </svg>
                </a>
            </div>
        </div>
    </footer>
</body>
</html>
